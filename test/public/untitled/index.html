
<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Untitled | Nerd-Emoji Web</title>
    <link rel="stylesheet" href="https://thecarsonwest.github.io/css/style.css" />
    <link rel="stylesheet" href="https://thecarsonwest.github.io/css/fonts.css" />
    <link rel="icon" type="image/x-icon" href="https://thecarsonwest.github.io/nerd-emoji.ico">
    <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$']]
    },
    svg: {
      fontCache: 'global'
    }
  };
  </script>
    
  </head>

  <body>

    <nav>
    <ul class="menu">
      
    </ul>
    <hr/>
    </nav>
<div class="article-meta">
<h1><span class="title">Untitled</span></h1>
<h2 class="author">Carson West</h2>

</div>

<main>
<p>implement this following code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">generate_relay_combinations</span>(data):
</span></span><span style="display:flex;"><span>    combinations <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(len(data)):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> range(len(data)):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> z <span style="color:#f92672">in</span> range(len(data)):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> a <span style="color:#f92672">in</span> range(len(data)):
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> len({x, y, z, a}) <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>:  <span style="color:#75715e"># Ensuring no repetition of individuals</span>
</span></span><span style="display:flex;"><span>                        combination <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>                            (data[x][<span style="color:#ae81ff">0</span>], data[x][<span style="color:#ae81ff">2</span>]<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>                            (data[y][<span style="color:#ae81ff">0</span>], data[y][<span style="color:#ae81ff">3</span>]<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>                            (data[z][<span style="color:#ae81ff">0</span>], data[z][<span style="color:#ae81ff">4</span>]<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>                            (data[a][<span style="color:#ae81ff">0</span>], data[a][<span style="color:#ae81ff">1</span>]<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>                        ]
</span></span><span style="display:flex;"><span>                        total_time <span style="color:#f92672">=</span> sum(time <span style="color:#66d9ef">for</span> (_, time) <span style="color:#f92672">in</span> combination)
</span></span><span style="display:flex;"><span>                        combinations<span style="color:#f92672">.</span>append((combination, total_time))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    combinations<span style="color:#f92672">.</span>sort(key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> x: x[<span style="color:#ae81ff">1</span>])  <span style="color:#75715e"># Sort combinations by total time</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> combinations
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>relay_combinations <span style="color:#f92672">=</span> generate_relay_combinations(data)
</span></span><span style="display:flex;"><span>csv_filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;relay_combinations_f.csv&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(csv_filename, <span style="color:#e6db74">&#39;w&#39;</span>, newline<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>) <span style="color:#66d9ef">as</span> csvfile:
</span></span><span style="display:flex;"><span>    csv_writer <span style="color:#f92672">=</span> csv<span style="color:#f92672">.</span>writer(csvfile)
</span></span><span style="display:flex;"><span>    csv_writer<span style="color:#f92672">.</span>writerow([<span style="color:#e6db74">&#39;Total Time&#39;</span>, <span style="color:#e6db74">&#39;Position 1 Name&#39;</span>, <span style="color:#e6db74">&#39;Position 2 Name&#39;</span>, <span style="color:#e6db74">&#39;Position 3 Name&#39;</span>, <span style="color:#e6db74">&#39;Position 4 Name&#39;</span>, <span style="color:#e6db74">&#39;Position 1 Time&#39;</span>, <span style="color:#e6db74">&#39;Position 2 Time&#39;</span>, <span style="color:#e6db74">&#39;Position 3 Time&#39;</span>, <span style="color:#e6db74">&#39;Position 4 Time&#39;</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> index, (combination, total_time) <span style="color:#f92672">in</span> enumerate(relay_combinations, start<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        row <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>            total_time,
</span></span><span style="display:flex;"><span>            combination[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>], combination[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>], combination[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>], combination[<span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">0</span>],
</span></span><span style="display:flex;"><span>            combination[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>], combination[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>], combination[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>], combination[<span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>        csv_writer<span style="color:#f92672">.</span>writerow(row)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Successfully written relay combinations to </span><span style="color:#e6db74">{</span>csv_filename<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>end <span style="color:#f92672">=</span> datetime<span style="color:#f92672">.</span>now()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>td <span style="color:#f92672">=</span> (end <span style="color:#f92672">-</span> start)<span style="color:#f92672">.</span>total_seconds() <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span><span style="color:#f92672">**</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;The time of execution of above program is : </span><span style="color:#e6db74">{</span>td<span style="color:#e6db74">:</span><span style="color:#e6db74">.03f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">ms&#34;</span>)
</span></span></code></pre></div><p>to work with these classes and methods</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> relay <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> openpyxl <span style="color:#f92672">import</span> load_workbook
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">string_to_time</span>(str): <span style="color:#75715e"># mm:ss.ss -&gt; Float point in fractions of a day</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>      f <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;:&#34;</span> <span style="color:#f92672">in</span> str:
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">+=</span> int(str<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;:&#34;</span>)[<span style="color:#ae81ff">0</span>])<span style="color:#f92672">*</span><span style="color:#ae81ff">60</span>
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">+=</span> int(str<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;:&#34;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;.&#34;</span>)[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">+=</span> int(str<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;.&#34;</span>)[<span style="color:#ae81ff">1</span>])<span style="color:#f92672">/</span><span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            f<span style="color:#f92672">+=</span> int(str<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;.&#34;</span>)[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>            f<span style="color:#f92672">+=</span> int(str<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;.&#34;</span>)[<span style="color:#ae81ff">1</span>])<span style="color:#f92672">/</span><span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> f<span style="color:#f92672">/</span><span style="color:#ae81ff">86400</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">time_to_string</span>(fraction_of_day): <span style="color:#75715e"># Day Fraction float point -&gt; mm:ss.ss</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Convert fraction_of_day to total seconds</span>
</span></span><span style="display:flex;"><span>    total_seconds <span style="color:#f92672">=</span> fraction_of_day <span style="color:#f92672">*</span> <span style="color:#ae81ff">86400</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Calculate minutes and seconds</span>
</span></span><span style="display:flex;"><span>    minutes, seconds <span style="color:#f92672">=</span> divmod(total_seconds, <span style="color:#ae81ff">60</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Format the result as mm:ss.00</span>
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>int(minutes)<span style="color:#e6db74">:</span><span style="color:#e6db74">02</span><span style="color:#e6db74">}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{</span>int(seconds)<span style="color:#e6db74">:</span><span style="color:#e6db74">02</span><span style="color:#e6db74">}</span><span style="color:#e6db74">.</span><span style="color:#e6db74">{</span>int((seconds <span style="color:#f92672">%</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>)<span style="color:#e6db74">:</span><span style="color:#e6db74">02</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">remove_last_word</span>(sentence):
</span></span><span style="display:flex;"><span>    words <span style="color:#f92672">=</span> sentence<span style="color:#f92672">.</span>rsplit(<span style="color:#e6db74">&#39; &#39;</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(words) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> words[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Team</span>: <span style="color:#75715e"># Team Class, contains the name of the team, and a list of Swimmer objects who are on the team. Usage: team = Team(&#34;&lt;url of home page&gt;&#34;)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;b&#34;</span>,u <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;l&#34;</span>,s <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> u <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;j&#39;</span>: <span style="color:#75715e"># Json team loader</span>
</span></span><span style="display:flex;"><span>            t <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(open(url,<span style="color:#e6db74">&#34;r&#34;</span>)<span style="color:#f92672">.</span>read())
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> t[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>url <span style="color:#f92672">=</span> t[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>team_m <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>team_f <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> t[<span style="color:#ae81ff">1</span>]:
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>team_m<span style="color:#f92672">.</span>append(Swimmer(x,<span style="color:#e6db74">&#34;l&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> t[<span style="color:#ae81ff">2</span>]:
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>team_f<span style="color:#f92672">.</span>append(Swimmer(x,<span style="color:#e6db74">&#34;l&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> url <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;b&#34;</span>: <span style="color:#75715e"># Blank team loader</span>
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>team_m <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>team_f <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Blank&#34;</span>
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Unnamed&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>: <span style="color:#75715e"># url loader</span>
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;Url detected, finding data&#39;</span>)
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>url <span style="color:#f92672">=</span> url <span style="color:#75715e"># for safekeeping the future</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            html_m <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;roster/?page=1&amp;gender=M&amp;season_id=27&amp;sort=perf&#34;</span>)<span style="color:#f92672">.</span>text<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;tbody&gt;&#34;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;/tbody&gt;&#34;</span>)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;tr </span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">          &gt;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>) <span style="color:#75715e"># Cuts down the HTML page to just the roster</span>
</span></span><span style="display:flex;"><span>            html_f <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;roster/?page=1&amp;gender=F&amp;season_id=27&amp;sort=perf&#34;</span>)<span style="color:#f92672">.</span>text<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;tbody&gt;&#34;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;/tbody&gt;&#34;</span>)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;tr </span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">          &gt;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            html_m<span style="color:#f92672">.</span>pop(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>            html_f<span style="color:#f92672">.</span>pop(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;roster/?page=1&amp;gender=M&amp;season_id=27&amp;sort=perf&#34;</span>)<span style="color:#f92672">.</span>text<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;&lt;meta property=&#34;og:title&#34; content=&#34;&#39;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;&#34;&#39;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>team_m <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>team_f <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> html_m:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> html_m:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;href&#39;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> x<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;            &lt;td class=&#34;u-text-end&#34;&gt;&#39;</span>)[<span style="color:#ae81ff">1</span>]:
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>                    self<span style="color:#f92672">.</span>team_m<span style="color:#f92672">.</span>append(Swimmer(<span style="color:#e6db74">&#34;https://www.swimcloud.com&#34;</span> <span style="color:#f92672">+</span> x<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;/td&gt;&#34;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;href=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&gt;&#34;</span>)[<span style="color:#ae81ff">0</span>]))
</span></span><span style="display:flex;"><span>                    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Added </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>team_m[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> s:
</span></span><span style="display:flex;"><span>                        self<span style="color:#f92672">.</span>save()
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> html_f:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;href&#39;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> x<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;            &lt;td class=&#34;u-text-end&#34;&gt;&#39;</span>)[<span style="color:#ae81ff">1</span>]: <span style="color:#75715e">###</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>                    self<span style="color:#f92672">.</span>team_f<span style="color:#f92672">.</span>append(Swimmer(<span style="color:#e6db74">&#34;https://www.swimcloud.com&#34;</span> <span style="color:#f92672">+</span> x<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;/td&gt;&#34;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;href=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&gt;&#34;</span>)[<span style="color:#ae81ff">0</span>]))
</span></span><span style="display:flex;"><span>                    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Added </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>team_f[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> s:
</span></span><span style="display:flex;"><span>                        self<span style="color:#f92672">.</span>save()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __str__(self): <span style="color:#75715e"># to string(very long)</span>
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">+=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>name<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>url<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">Men:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>team_m:
</span></span><span style="display:flex;"><span>            f <span style="color:#f92672">+=</span> str(x)
</span></span><span style="display:flex;"><span>            f <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">Women:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>team_f:
</span></span><span style="display:flex;"><span>            f <span style="color:#f92672">+=</span> str(x)
</span></span><span style="display:flex;"><span>            f <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> f
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">save</span>(self): <span style="color:#75715e"># Saves file to json</span>
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;[ [</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;,</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>url<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">],</span><span style="color:#ae81ff">\n\t</span><span style="color:#e6db74">[</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>team_m:
</span></span><span style="display:flex;"><span>            f <span style="color:#f92672">+=</span> x<span style="color:#f92672">.</span>save()
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">=</span> f[<span style="color:#ae81ff">0</span>:len(f)<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n\t</span><span style="color:#e6db74">],</span><span style="color:#ae81ff">\n\t</span><span style="color:#e6db74">[&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>team_f:
</span></span><span style="display:flex;"><span>            f <span style="color:#f92672">+=</span> x<span style="color:#f92672">.</span>save()
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">=</span> f[<span style="color:#ae81ff">0</span>:len(f)<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>] <span style="color:#75715e"># Gets rid of the last comma</span>
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n\t</span><span style="color:#e6db74">]</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">]&#39;</span>
</span></span><span style="display:flex;"><span>        file <span style="color:#f92672">=</span> open(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>name<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39; &#39;</span>,<span style="color:#e6db74">&#39;_&#39;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">.json&#34;</span>,<span style="color:#e6db74">&#39;w&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        file<span style="color:#f92672">.</span>write(f)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(self,player,gender<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;m&#34;</span>): <span style="color:#75715e"># Adds Swimmer() to team_m or team_f</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> gender<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;m&#34;</span>:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>team_m<span style="color:#f92672">.</span>append(player)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> gender<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;f&#34;</span>:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>team_f<span style="color:#f92672">.</span>append(player)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">remove</span>(self,player): <span style="color:#75715e"># removes player by name</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> t <span style="color:#f92672">in</span> [self<span style="color:#f92672">.</span>team_m,self<span style="color:#f92672">.</span>team_f]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> p <span style="color:#f92672">in</span> range(len(t)):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> t[p]<span style="color:#f92672">.</span>name <span style="color:#f92672">==</span> player:
</span></span><span style="display:flex;"><span>                    print(<span style="color:#e6db74">&#34;removed &#34;</span><span style="color:#f92672">+</span> t<span style="color:#f92672">.</span>pop(p))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">refresh</span>(self,person <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> person <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            self <span style="color:#f92672">=</span> Team(self<span style="color:#f92672">.</span>url)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">save_to_workbook</span>(self, template_file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;./template.xlsx&#39;</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Load the template Excel file</span>
</span></span><span style="display:flex;"><span>        template_wb <span style="color:#f92672">=</span> load_workbook(template_file)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Get the desired sheet from the template file to combine data</span>
</span></span><span style="display:flex;"><span>        time_sheet <span style="color:#f92672">=</span> template_wb[<span style="color:#e6db74">&#39;Time Sheet&#39;</span>]  <span style="color:#75715e"># Assuming the sheet is named &#34;Time Sheet&#34;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        importer <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        l <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>  <span style="color:#75715e"># Starting row index</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> swimmer <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>team_m <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>team_f:
</span></span><span style="display:flex;"><span>            s_name <span style="color:#f92672">=</span> swimmer<span style="color:#f92672">.</span>name
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> event, details <span style="color:#f92672">in</span> swimmer<span style="color:#f92672">.</span>times<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>                r <span style="color:#f92672">=</span> [s_name]
</span></span><span style="display:flex;"><span>                r<span style="color:#f92672">.</span>append(event)
</span></span><span style="display:flex;"><span>                r<span style="color:#f92672">.</span>append(details[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>                r<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#34;&#34;</span>)  <span style="color:#75715e"># Placeholder for the third column</span>
</span></span><span style="display:flex;"><span>                r<span style="color:#f92672">.</span>append(details[<span style="color:#ae81ff">1</span>])  <span style="color:#75715e"># Assuming the same time</span>
</span></span><span style="display:flex;"><span>                r<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#34;&#34;</span>)  <span style="color:#75715e"># Placeholder for the sixth column</span>
</span></span><span style="display:flex;"><span>                r<span style="color:#f92672">.</span>append(details[<span style="color:#ae81ff">0</span>])  <span style="color:#75715e"># String to time conversion (assuming it&#39;s the same format)</span>
</span></span><span style="display:flex;"><span>                r<span style="color:#f92672">.</span>append(swimmer <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>team_m)  <span style="color:#75715e"># True for male, False for female</span>
</span></span><span style="display:flex;"><span>                r<span style="color:#f92672">.</span>append(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;=G</span><span style="color:#e6db74">{</span>l<span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;HLOOKUP(B</span><span style="color:#e6db74">{</span>l<span style="color:#e6db74">}</span><span style="color:#e6db74">,Table7[#All],IF(&#39;Time Sheet&#39;!H</span><span style="color:#e6db74">{</span>l<span style="color:#e6db74">}</span><span style="color:#e6db74">,3,2),FALSE)&#34;</span>)
</span></span><span style="display:flex;"><span>                importer<span style="color:#f92672">.</span>append(r)
</span></span><span style="display:flex;"><span>                l <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Write data to the template sheet</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> row_data <span style="color:#f92672">in</span> importer:
</span></span><span style="display:flex;"><span>            time_sheet<span style="color:#f92672">.</span>append(row_data)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Time Sheet Created&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Add names to Boys and Girls sheets</span>
</span></span><span style="display:flex;"><span>        sheet_m <span style="color:#f92672">=</span> template_wb[<span style="color:#e6db74">&#39;Boys&#39;</span>]
</span></span><span style="display:flex;"><span>        sheet_f <span style="color:#f92672">=</span> template_wb[<span style="color:#e6db74">&#39;Girls&#39;</span>]
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> swimmer <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>team_m:
</span></span><span style="display:flex;"><span>            sheet_m[<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;A</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>] <span style="color:#f92672">=</span> swimmer<span style="color:#f92672">.</span>name
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> swimmer <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>team_f:
</span></span><span style="display:flex;"><span>            sheet_f[<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;A</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>] <span style="color:#f92672">=</span> swimmer<span style="color:#f92672">.</span>name
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;Names put in the sheet&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Save the workbook</span>
</span></span><span style="display:flex;"><span>        csv_filename <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>name<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39; &#39;</span>, <span style="color:#e6db74">&#39;_&#39;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">.xlsx&#34;</span>
</span></span><span style="display:flex;"><span>        template_wb<span style="color:#f92672">.</span>save(csv_filename)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Workbook Saved as </span><span style="color:#e6db74">{</span>csv_filename<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Swimmer</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, url, u <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;u&#34;</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> u <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;l&#34;</span>: <span style="color:#75715e"># Loads from list(what a json load will do)</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> url[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>url <span style="color:#f92672">=</span> url[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>times <span style="color:#f92672">=</span> url[<span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>: <span style="color:#75715e"># otherwise loads from url</span>
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>url <span style="color:#f92672">=</span> url
</span></span><span style="display:flex;"><span>            html <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url)<span style="color:#f92672">.</span>text<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;body&#34;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;&lt;span class=&#34;u-mr-&#34;&gt;&#39;</span>)[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> html<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;&lt;/span&gt;&#39;</span>)[<span style="color:#ae81ff">0</span>] <span style="color:#75715e"># Scraping name from top of page</span>
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>times <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>            table <span style="color:#f92672">=</span> html<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;tbody&gt;&#34;</span>)[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;/tbody&gt;&#34;</span>)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;/tr&gt;&#34;</span>)
</span></span><span style="display:flex;"><span>            table<span style="color:#f92672">.</span>pop(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> table:
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                td <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;/td&gt;&#34;</span>) <span style="color:#75715e"># Scraping the times table</span>
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>times[td[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;&lt;td class=&#34;u-text-truncate&#34;&gt;&#39;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;class=&#34;js-event-link&#34;&gt;&#39;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;/&#34;</span>)[<span style="color:#ae81ff">0</span>]] <span style="color:#f92672">=</span> [string_to_time(td[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;/a&gt;&#34;</span>)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;&#34;&gt;&#39;</span>)[<span style="color:#ae81ff">2</span>]),td[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&lt;/a&gt;&#34;</span>)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;&#34;&gt;&#39;</span>)[<span style="color:#ae81ff">2</span>]]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __str__(self):
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span> <span style="color:#75715e"># Prints name an times</span>
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">+=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>name<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>url<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>times:
</span></span><span style="display:flex;"><span>            f <span style="color:#f92672">+=</span> str(x)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;:  &#39;</span> <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>times[x][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>            f <span style="color:#f92672">+=</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> f
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">save</span>(self): <span style="color:#75715e"># formats to conform with Team() json</span>
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\t\t</span><span style="color:#e6db74">[</span><span style="color:#ae81ff">\n\t\t\t</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;, &#34;</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>url<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;,</span><span style="color:#ae81ff">\n\t\t\t</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#39;{&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>times:             
</span></span><span style="display:flex;"><span>            f <span style="color:#f92672">+=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n\t\t\t\t</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>str(x)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; : </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>times[x]<span style="color:#e6db74">}</span><span style="color:#e6db74">,&#39;</span><span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;&#39;&#34;</span>,<span style="color:#e6db74">&#39;&#34;&#39;</span>)
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">=</span> f[<span style="color:#ae81ff">0</span>:len(f)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        f <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n\t\t\t</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\n\t\t</span><span style="color:#e6db74">],</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> f
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Entries: {&#34;Event&#34; : [Swimmer, ...], ...}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Name: String
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Date: Excel Format(Days since 1/1/1900) **NOT UNIX** 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Entry</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, entries <span style="color:#f92672">=</span> {}, name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Untitled team&#34;</span>): 
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>entries <span style="color:#f92672">=</span> entries
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>name <span style="color:#f92672">=</span> name
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_ranks</span>(team, event, num, s <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>): <span style="color:#75715e"># Returns the *num* fastest times in [name, time] format</span>
</span></span><span style="display:flex;"><span>    t <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    f <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> s:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> team<span style="color:#f92672">.</span>team_m:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> event <span style="color:#f92672">in</span> x<span style="color:#f92672">.</span>times:
</span></span><span style="display:flex;"><span>                t<span style="color:#f92672">.</span>append([x<span style="color:#f92672">.</span>name,x<span style="color:#f92672">.</span>times[event][<span style="color:#ae81ff">0</span>]])
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> sorted(t, key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> x: x[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(num):
</span></span><span style="display:flex;"><span>            f<span style="color:#f92672">.</span>append(t[x])
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> f
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>: <span style="color:#75715e"># Shot myself in the foot with these data structures, only way i know of doing this   </span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> team<span style="color:#f92672">.</span>team_f:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> event <span style="color:#f92672">in</span> x<span style="color:#f92672">.</span>times:
</span></span><span style="display:flex;"><span>                t<span style="color:#f92672">.</span>append([x<span style="color:#f92672">.</span>name,x<span style="color:#f92672">.</span>times[event][<span style="color:#ae81ff">0</span>]])
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> sorted(t, key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> x: x[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(num):
</span></span><span style="display:flex;"><span>            f<span style="color:#f92672">.</span>append(t[x])
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> f
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_rank_obj</span>(team, event, num, s<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>):
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;&#34;&#34;Returns a sorted list of Swimmer objects with the fastest times for an event.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  Args:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      team: Team object containing swimmer data.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      event: Event name (e.g., &#34;100 Free&#34;).
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      num: Number of fastest times to return.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      s: Flag indicating men&#39;s (True) or women&#39;s (False) swimmers.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  Returns:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      A list of Swimmer objects sorted by their time in the specified event.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  swimmers <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> s:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> swimmer <span style="color:#f92672">in</span> team<span style="color:#f92672">.</span>team_m:
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> event <span style="color:#f92672">in</span> swimmer<span style="color:#f92672">.</span>times:
</span></span><span style="display:flex;"><span>        swimmers<span style="color:#f92672">.</span>append(swimmer)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> swimmer <span style="color:#f92672">in</span> team<span style="color:#f92672">.</span>team_f:
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> event <span style="color:#f92672">in</span> swimmer<span style="color:#f92672">.</span>times:
</span></span><span style="display:flex;"><span>        swimmers<span style="color:#f92672">.</span>append(swimmer)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Sort swimmers by their time in the specified event</span>
</span></span><span style="display:flex;"><span>  swimmers<span style="color:#f92672">.</span>sort(key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> swimmer: swimmer<span style="color:#f92672">.</span>times[event][<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> swimmers[:num]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Things to do add some point
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">make exportable to .hy3
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#events_order = [&#39;200 Y Medley Relay Women&#39;,&#39;200 Y Medley Relay Men&#39;,&#39;200 Y Free Women&#39;,&#39;200 Y Free Men&#39;,&#39;200 Y IM Women&#39;,&#39;200 Y IM Men&#39;,&#39;50 Y Free Women&#39;,&#39;50 Y Free Men&#39;,&#39;100 Y Fly Women&#39;,&#39;100 Y Fly Men&#39;,&#39;100 Y Free Women&#39;,&#39;100 Y Free Men&#39;,&#39;500 Y Free Women&#39;,&#39;500 Y Free Men&#39;,&#39;200 Y Free Relay Women&#39;,&#39;200 Y Free Relay Men&#39;,&#39;100 Y Back Women&#39;,&#39;100 Y Back Men&#39;,&#39;100 Y Breast Women&#39;,&#39;100 Y Breast Men&#39;,&#39;400 Y Free Relay Women&#39;,&#39;400 Y Free Relay Men&#39;]</span>
</span></span><span style="display:flex;"><span>events_order <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;200 Y Free Women&#39;</span>,<span style="color:#e6db74">&#39;200 Y Free Men&#39;</span>,<span style="color:#e6db74">&#39;200 Y IM Women&#39;</span>,<span style="color:#e6db74">&#39;200 Y IM Men&#39;</span>,<span style="color:#e6db74">&#39;50 Y Free Women&#39;</span>,<span style="color:#e6db74">&#39;50 Y Free Men&#39;</span>,<span style="color:#e6db74">&#39;100 Y Fly Women&#39;</span>,<span style="color:#e6db74">&#39;100 Y Fly Men&#39;</span>,<span style="color:#e6db74">&#39;100 Y Free Women&#39;</span>,<span style="color:#e6db74">&#39;100 Y Free Men&#39;</span>,<span style="color:#e6db74">&#39;500 Y Free Women&#39;</span>,<span style="color:#e6db74">&#39;500 Y Free Men&#39;</span>,<span style="color:#e6db74">&#39;100 Y Back Women&#39;</span>,<span style="color:#e6db74">&#39;100 Y Back Men&#39;</span>,<span style="color:#e6db74">&#39;100 Y Breast Women&#39;</span>,<span style="color:#e6db74">&#39;100 Y Breast Men&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">t : [Entry class, ...]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Point Scale: Default is the standard high school point scale
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Point Swimmers: Most high school meets only allow 4 swimmers to compete for points
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Divergence: [Lower, upper] The Random variability in times, how much percent can be added and dropped(scaled to wr) WIP
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Fatigue: [Enabled, Decrease, Wear-off] WIP
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> - Whether or not this feature is enabled
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> - If fatigue is enabled, how much will it slow a swimmer down while doing consecutive events?
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> - How many events will it take for fatigue to wear off(or how much time?)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hs_meet</span>(t, point_swimmers <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span> ,divergence <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], fatigue <span style="color:#f92672">=</span> [<span style="color:#66d9ef">False</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>],point_scale <span style="color:#f92672">=</span> [<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">17</span>,<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]):
</span></span><span style="display:flex;"><span>    s <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> len(t) <span style="color:#75715e"># Scores for each team</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> event <span style="color:#f92672">in</span> events_order:
</span></span><span style="display:flex;"><span>        psych_sheet <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> team <span style="color:#f92672">in</span> range(len(t)): <span style="color:#75715e"># For every team in teams</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> swimmer <span style="color:#f92672">in</span> t[team]<span style="color:#f92672">.</span>entries[event]: <span style="color:#75715e"># For every swimmer in the team</span>
</span></span><span style="display:flex;"><span>                psych_sheet<span style="color:#f92672">.</span>append([swimmer,s[team]]) <span style="color:#75715e"># Append [swimmer, score reference]</span>
</span></span><span style="display:flex;"><span>        psych_sheet<span style="color:#f92672">.</span>sort(key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> x: min(x[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>times[event]))
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">best_entries</span>(team, count): <span style="color:#75715e"># Cheats and simply assigns the &lt;count&gt; best swimmers to each event, genetic algorithms relays</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Made for testing purposes</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Not legal event entries</span>
</span></span><span style="display:flex;"><span>    events <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> events_order:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> x <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#34;200 Y Medley Relay Men&#34;</span>,<span style="color:#e6db74">&#34;200 Y Free Relay Men&#34;</span>,<span style="color:#e6db74">&#34;400 Y Free Relay Men&#34;</span>,<span style="color:#e6db74">&#34;200 Y Medley Relay Women&#34;</span>,<span style="color:#e6db74">&#34;200 Y Free Relay Women&#34;</span>,<span style="color:#e6db74">&#34;400 Y Free Relay Women&#34;</span>]:
</span></span><span style="display:flex;"><span>            events[x] <span style="color:#f92672">=</span> get_rank_obj(team,remove_last_word(x),count,<span style="color:#e6db74">&#34;Men&#34;</span> <span style="color:#f92672">in</span> x)
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    best_relays = genetic_algorithm(team,10000,0,0)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    events[&#34;200 Y Medley Relay Men&#34;] = best_relays[0]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    events[&#34;200 Y Free Relay Men&#34;] = best_relays[1]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    events[&#34;400 Y Free Relay Men&#34;] = best_relays[2]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    best_relays = genetic_algorithm(team,10000,0,0,False)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    events[&#34;200 Y Medley Relay Women&#34;] = best_relays[0]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    events[&#34;200 Y Free Relay Women&#34;] = best_relays[1]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    events[&#34;400 Y Free Relay Women&#34;] = best_relays[2]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Entry(events,team<span style="color:#f92672">.</span>name)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">genetic_entries</span>(team): <span style="color:#75715e"># Genetic algorithms entries WIP</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pass</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> csv
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> datetime
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> openpyxl <span style="color:#f92672">import</span> load_workbook
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ... (Existing code from your provided classes and methods)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">generate_relay_combinations</span>(data, relay_type):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Generates relay combinations based on relay type.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    combinations <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">=</span> len(data)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> z <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> a <span style="color:#f92672">in</span> range(n):
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> len({x, y, z, a}) <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>:
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">if</span> relay_type <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;medley&#34;</span>:
</span></span><span style="display:flex;"><span>                            combination <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>                                (data[x]<span style="color:#f92672">.</span>name, data[x]<span style="color:#f92672">.</span>times<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;100 Y Back&#39;</span>, [float(<span style="color:#e6db74">&#39;inf&#39;</span>), <span style="color:#e6db74">&#39;&#39;</span>])[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>),  <span style="color:#75715e"># Use get with default for missing events</span>
</span></span><span style="display:flex;"><span>                                (data[y]<span style="color:#f92672">.</span>name, data[y]<span style="color:#f92672">.</span>times<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;100 Y Breast&#39;</span>, [float(<span style="color:#e6db74">&#39;inf&#39;</span>), <span style="color:#e6db74">&#39;&#39;</span>])[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>                                (data[z]<span style="color:#f92672">.</span>name, data[z]<span style="color:#f92672">.</span>times<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;100 Y Fly&#39;</span>, [float(<span style="color:#e6db74">&#39;inf&#39;</span>), <span style="color:#e6db74">&#39;&#39;</span>])[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>                                (data[a]<span style="color:#f92672">.</span>name, data[a]<span style="color:#f92672">.</span>times<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;100 Y Free&#39;</span>, [float(<span style="color:#e6db74">&#39;inf&#39;</span>), <span style="color:#e6db74">&#39;&#39;</span>])[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>                            ]
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">elif</span> relay_type <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;free&#34;</span>:
</span></span><span style="display:flex;"><span>                            combination <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>                                (data[x]<span style="color:#f92672">.</span>name, data[x]<span style="color:#f92672">.</span>times<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;100 Y Free&#39;</span>, [float(<span style="color:#e6db74">&#39;inf&#39;</span>), <span style="color:#e6db74">&#39;&#39;</span>])[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>                                (data[y]<span style="color:#f92672">.</span>name, data[y]<span style="color:#f92672">.</span>times<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;100 Y Free&#39;</span>, [float(<span style="color:#e6db74">&#39;inf&#39;</span>), <span style="color:#e6db74">&#39;&#39;</span>])[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>                                (data[z]<span style="color:#f92672">.</span>name, data[z]<span style="color:#f92672">.</span>times<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;100 Y Free&#39;</span>, [float(<span style="color:#e6db74">&#39;inf&#39;</span>), <span style="color:#e6db74">&#39;&#39;</span>])[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>                                (data[a]<span style="color:#f92672">.</span>name, data[a]<span style="color:#f92672">.</span>times<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;100 Y Free&#39;</span>, [float(<span style="color:#e6db74">&#39;inf&#39;</span>), <span style="color:#e6db74">&#39;&#39;</span>])[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>                            ]
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                            <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">&#34;Invalid relay_type. Must be &#39;medley&#39; or &#39;free&#39;.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">if</span> any(time <span style="color:#f92672">==</span> float(<span style="color:#e6db74">&#39;inf&#39;</span>) <span style="color:#66d9ef">for</span> _, time <span style="color:#f92672">in</span> combination):
</span></span><span style="display:flex;"><span>                            <span style="color:#66d9ef">continue</span>  <span style="color:#75715e"># Skip combinations with missing times</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                        total_time <span style="color:#f92672">=</span> sum(time <span style="color:#66d9ef">for</span> _, time <span style="color:#f92672">in</span> combination)
</span></span><span style="display:flex;"><span>                        combinations<span style="color:#f92672">.</span>append((combination, total_time))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    combinations<span style="color:#f92672">.</span>sort(key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> x: x[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> combinations
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">write_relay_combinations_to_csv</span>(combinations, csv_filename):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Writes relay combinations to a CSV file.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(csv_filename, <span style="color:#e6db74">&#39;w&#39;</span>, newline<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>) <span style="color:#66d9ef">as</span> csvfile:
</span></span><span style="display:flex;"><span>        csv_writer <span style="color:#f92672">=</span> csv<span style="color:#f92672">.</span>writer(csvfile)
</span></span><span style="display:flex;"><span>        csv_writer<span style="color:#f92672">.</span>writerow([<span style="color:#e6db74">&#39;Total Time&#39;</span>, <span style="color:#e6db74">&#39;Position 1 Name&#39;</span>, <span style="color:#e6db74">&#39;Position 2 Name&#39;</span>, <span style="color:#e6db74">&#39;Position 3 Name&#39;</span>, <span style="color:#e6db74">&#39;Position 4 Name&#39;</span>,
</span></span><span style="display:flex;"><span>                             <span style="color:#e6db74">&#39;Position 1 Time&#39;</span>, <span style="color:#e6db74">&#39;Position 2 Time&#39;</span>, <span style="color:#e6db74">&#39;Position 3 Time&#39;</span>, <span style="color:#e6db74">&#39;Position 4 Time&#39;</span>])
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> index, (combination, total_time) <span style="color:#f92672">in</span> enumerate(combinations, start<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>            row <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>                total_time,
</span></span><span style="display:flex;"><span>                combination[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>], combination[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>], combination[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>], combination[<span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">0</span>],
</span></span><span style="display:flex;"><span>                combination[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>], combination[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>], combination[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>], combination[<span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>            ]
</span></span><span style="display:flex;"><span>            csv_writer<span style="color:#f92672">.</span>writerow(row)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Successfully written relay combinations to </span><span style="color:#e6db74">{</span>csv_filename<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Example usage:</span>
</span></span><span style="display:flex;"><span>start <span style="color:#f92672">=</span> datetime<span style="color:#f92672">.</span>now()
</span></span><span style="display:flex;"><span>team <span style="color:#f92672">=</span> Team(<span style="color:#e6db74">&#34;&lt;your_team_url&gt;&#34;</span>)  <span style="color:#75715e"># Replace with your team&#39;s SwimCloud URL</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>relay_combinations_free <span style="color:#f92672">=</span> generate_relay_combinations(team<span style="color:#f92672">.</span>team_m, <span style="color:#e6db74">&#34;free&#34;</span>) <span style="color:#75715e"># Example for men&#39;s free relay</span>
</span></span><span style="display:flex;"><span>write_relay_combinations_to_csv(relay_combinations_free, <span style="color:#e6db74">&#39;relay_combinations_free_men.csv&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>relay_combinations_medley <span style="color:#f92672">=</span> generate_relay_combinations(team<span style="color:#f92672">.</span>team_f, <span style="color:#e6db74">&#34;medley&#34;</span>) <span style="color:#75715e"># Example for women&#39;s medley relay</span>
</span></span><span style="display:flex;"><span>write_relay_combinations_to_csv(relay_combinations_medley, <span style="color:#e6db74">&#39;relay_combinations_medley_women.csv&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>end <span style="color:#f92672">=</span> datetime<span style="color:#f92672">.</span>now()
</span></span><span style="display:flex;"><span>td <span style="color:#f92672">=</span> (end <span style="color:#f92672">-</span> start)<span style="color:#f92672">.</span>total_seconds() <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span><span style="color:#f92672">**</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;The time of execution of above program is :</span>
</span></span></code></pre></div>
</main>

  <footer>
  
  
  </footer>
  <script src="//instant.page/5.2.0" type="module" integrity="sha384-jnZyxPjiipYXnSU0ygqeac2q7CVYMbh84q0uHVRRxEtvFPiQYbXWUorga2aqZJ0z"></script>
  </body>
</html>

